!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["appsync-nodejs"]=t():e["appsync-nodejs"]=t()}(global,(function(){return(()=>{"use strict";var e={203:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.APIClass=void 0;const n=r(386);class i{constructor(){this._config=null,this._graphqlApi=null,this._graphqlApi=new n.GraphQLAPIClass}configure(e){if(!this._graphqlApi)throw new Error("Missing instance of GraphQLAPI");this._config=e,this._graphqlApi.configure(e)}graphql(e){if(!this._graphqlApi)throw new Error("Missing instance of GraphQLAPI");return this._graphqlApi.graphql(e)}}t.APIClass=i;const o=new i;t.default=o},386:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GraphQLAPIClass=t.graphqlOperation=void 0;const n=r(721),i=r(728),o=r(170);t.graphqlOperation=(e,t={})=>({query:e,variables:t}),t.GraphQLAPIClass=class{constructor(){this._config=null,this._restClient=null,this._restClient=new o.RestClient}configure(e){var t;this._config=e,null===(t=this._restClient)||void 0===t||t.configure(e)}graphql({query:e,variables:t={}}){const r=i.parse(e),[n={}]=r.definitions.filter((e=>"OperationDefinition"===e.kind)),{operation:o}=n;switch(o){case"query":case"mutation":return this._graphql({query:e,variables:t})}throw new Error(`invalid operation type: ${o}`)}async _graphql({query:e,variables:t}){if(!this._config)throw new Error("API has not been configured");if(!this._restClient)throw new Error("Rest Client was not properly configured");const{aws_appsync_graphqlEndpoint:r,aws_appsync_region:i,aws_appsync_apiKey:o}=this._config;if(!r)throw{data:{},errors:[new n.GraphQLError("No graphql endpoint provided.")]};let s,a={body:{},headers:{}};a.body={query:e,variables:t},o&&(a.headers["x-api-key"]=o);try{s=await this._restClient.post(r,a),console.log("gqlres",s)}catch(e){s={data:{},errors:[new n.GraphQLError(e.message)]}}const{errors:l}=s;if(l&&l.length)throw s;return s}}},170:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RestClient=void 0;const a=o(r(480)),l=s(r(376));t.RestClient=class{constructor(){this._config=null}configure(e){this._config=e}get(e,t){return this._ajax(e,"GET",t)}put(e,t){return this._ajax(e,"PUT",t)}patch(e,t){return this._ajax(e,"PATCH",t)}post(e,t){return this._ajax(e,"POST",t)}del(e,t){return this._ajax(e,"DELETE",t)}head(e,t){return this._ajax(e,"HEAD",t)}async _ajax(e,t,r){if(!this._config)throw new Error("RestClient was not properly configured: null config");const{aws_appsync_region:n}=this._config;if(!n)throw new Error("RestClient was not properly configured: missing region");let i={method:t,url:e,headers:{},data:null,responseType:"json",timeout:0},o={};const{host:s,path:a}=this._parseUrl(e);if(o.host=s,o.path=a,r.body&&(o["Content-Type"]="application/json; charset=UTF-8",i.data=JSON.stringify(r.body)),void 0===r.headers.Authorization){const t=this._getCreds(e,r);o={...o,...t}}return i.headers={...o,...r.headers},this._request(i)}_getCreds(e,t){if(!this._config)throw new Error("RestClient was not properly configured: null config");const{aws_appsync_region:r}=this._config;if(!r)throw new Error("RestClient was not properly configured: missing region");let n=new a.default.HttpRequest(new a.Endpoint(e),r);const{host:i,path:o}=this._parseUrl(e);return n.headers.host=i,n.headers.path=o,t.body&&(n.body=JSON.stringify(t.body)),new a.default.Signers.V4(n,"appsync",!0).addAuthorization(a.default.config.credentials,a.default.util.date.getDate()),n.headers}_request(e){return l.default(e).then((e=>e.data)).catch((e=>{throw console.error(e),e}))}_parseUrl(e){const t=e.split("/");return{host:t[2],path:"/"+t.slice(3).join("/")}}}},607:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=o(r(203));i(r(230),t),t.default=s.default},230:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.GRAPHQL_AUTH_MODE=void 0,(r=t.GRAPHQL_AUTH_MODE||(t.GRAPHQL_AUTH_MODE={})).API_KEY="API_KEY",r.AWS_IAM="AWS_IAM",r.AMAZON_COGNITO_USER_POOLS="AMAZON_COGNITO_USER_POOLS"},480:e=>{e.exports=require("aws-sdk")},376:e=>{e.exports=require("axios")},721:e=>{e.exports=require("graphql/error/GraphQLError")},728:e=>{e.exports=require("graphql/language/parser")}},t={};return function r(n){if(t[n])return t[n].exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}(607)})()}));